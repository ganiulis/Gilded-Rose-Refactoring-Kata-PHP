#!/usr/bin/env php
<?php

require_once __DIR__ . '/vendor/autoload.php';

use GildedRose\Data\FileContentRetriever;
use GildedRose\Command\TestFixtureCommand;
use GildedRose\Repository\ItemRepository;
use GildedRose\Serializer\ItemNormalizer;
use GildedRose\Serializer\ItemsNormalizer;

use Symfony\Component\Console\Application;
use Symfony\Component\Serializer\Encoder\CsvEncoder;

$application = new Application('Gilded Rose CLI', '0.1.1');


$commands = [
    new TestFixtureCommand(
        new ItemRepository(
            new FileContentRetriever,
            new CsvEncoder, 
            new ItemsNormalizer(new ItemNormalizer)
        )
    )
    // register new commands here
    ];

foreach ($commands as $command) {
    $application->add($command);
}

$application->run();
